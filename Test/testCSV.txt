*** Settings ***
Test Teardown     Close All Browsers
Library           Collections
Library           Selenium2Library
Library           ../Libraries/CSVLibrary.py
Library           ../Libraries/DBLibrary.py
Library           ../Libraries/Selenium2Extend.py
Resource          ../Interfaces/yahoo.txt
Resource          ../Interfaces/twitter.txt

*** Test Cases ***
Get Csv Column
    comment    Main steps
    ${data}    Get Csv Column    Data/test.csv    Name
    ${expect}    Create List    Lex    Dora    Alan    Lex
    Should Be Equal    ${data}    ${expect}

Lookup Csv Value
    comment    Main steps
    ${data}    Lookup Csv Value    Data/test.csv    Name    Lex    Title    2
    ${expect}    Set Variable    Dev
    Should Be Equal    ${data}    ${expect}

Lookup Csv Row
    comment    Main steps
    ${data}    Lookup Csv Row    Data/test.csv    Name    Lex    2
    ${expect}    Create Dictionary    Name=Lex    Age=30    Title=Dev
    Should Be Equal    ${data}    ${expect}

test DB
    Connect To Database By CfFile    Data${/}dbconfig
    Get Query Result Csv    select top 2 * from Customers    Data${/}output.csv
    ${ac_file}    Read Csv File    Data${/}output.csv    True
    Log List    ${ac_file}
    Get Query Result Excel    select top 2 * from Customers    Data${/}output.xlsx
    Disconnect From Database

testCustomAction
    Set Log Level    DEBUG
    Open Browser    https://twitter.com/
    # Test exists & visible
    ${ac_exists}    Does Element Exists    ${txtEmail}
    ${ac_visible}    Is Element Visible    ${txtEmail}
    ${ac_enabled}    Is Element Clickable    ${txtEmail}
    # Test text present
    ${ac_text_present}    Is Text Present In Element    ${txtEmail}    abc
    Input Text    ${txtEmail}    abc
    ${ac_text_present}    Is Text Present In Element    ${txtEmail}    abc
    # Test invisible
    ${ac_invisible}    Is Element Invisible    ${divHidden}
    ${ac_visible}    Is Element Visible    ${divHidden}
